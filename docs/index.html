<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ariton Profile Viewer</title>
    <meta
      name="description"
      content="Ariton is a decentralized platform for building and managing communities, offering tools for communication, marketplace, and more."
    />
    <meta
      name="keywords"
      content="Ariton, communities, decentralized, superapp, blockchain, AI"
    />
    <meta name="robots" content="index, follow" />
    <link rel="icon" type="image/png" href="assets/ariton-favicon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
      rel="stylesheet"
    />
    <!-- <link rel="stylesheet" type="text/css" href="app.css" /> -->
    <meta property="og:title" content="Ariton" />
    <meta
      property="og:description"
      content="Freedom to Connect, Power to Own"
    />
    <meta
      property="og:image"
      content="https://ariton.app/assets/ariton-social.png"
    />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:type" content="object" />
    <meta property="og:url" content="https://ariton.app" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Ariton - SuperApp for Communities" />
    <meta
      name="twitter:image"
      content="https://ariton.app/assets/ariton-social-x.png"
    />

    <style>
      :root {
        --background-color: rgb(255, 255, 255);
        --text-color: #000000;
        --logo-image: url("assets/ariton-icon-dark-stripped.svg");
        --logo-text: url("assets/ariton-text-dark.svg");
        --header-border: rgb(229, 229, 229);
        --section-background-color: rgb(245, 245, 245);
        --section-text-color: rgb(75, 85, 99);

        --button-background-color: rgb(23, 23, 23);
        --button-text-color: rgb(250, 250, 250);
      }

      [data-theme="dark"] {
        --background-color: rgb(13, 12, 12);
        --text-color: #ffffff;
        --logo-image: url("assets/ariton-icon-light-stripped.svg");
        --logo-text: url("assets/ariton-text-light.svg");
        --header-border: rgb(38, 38, 38);
        --section-background-color: rgb(23, 23, 23);
        --section-text-color: rgb(250, 250, 250);

        --button-background-color: rgb(250, 250, 250);
        --button-text-color: rgb(23, 23, 23);
      }

      html,
      body {
        width: 100%;
        margin: 0;
        padding: 0;
      }

      body {
        background-color: var(--background-color);
        color: var(--text-color);

        font-family: "Inter", sans-serif;
        font-optical-sizing: auto;
        font-weight: 400;
        font-style: normal;
        font-size: 18px;

        transition: background-color 0.4s, color 0.4s;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      button {
        font-family: "Inter", sans-serif;
        font-optical-sizing: auto;
        font-weight: 600;
        font-style: normal;
        font-size: 18px;
      }

      a {
        color: var(--text-color);
        text-decoration: none;
      }

      a:hover {
        text-decoration: underline;
      }

      .hero {
        text-align: center;
        min-height: 400px;
        height: calc(100vh - 80px - 80px);
        display: flex;
        justify-content: center;
        flex-direction: column;
        margin-bottom: 80px;
        color: var(--section-text-color);
      }

      .larger {
        font-size: 1.4em;
      }

      .centered {
        text-align: center;
      }

      .ariton-logo-container {
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: center;
        align-content: center;
        margin-right: 3em;
      }

      .ariton-logo {
        background-image: var(--logo-image);
        background-repeat: no-repeat;
        background-position: left center;
        width: 42px;
        height: 42px;
        margin-right: 0.4em;
      }

      .ariton-text {
        background-image: var(--logo-text);
        background-repeat: no-repeat;
        background-position: left center;
        width: 100px;
        height: 50px;
      }

      .ariton-logo-footer {
        background-image: var(--logo-image);
        background-repeat: no-repeat;
        background-position: left center;
        width: 128px;
        height: 128px;
      }

      button {
        background-color: var(--button-background-color);
        color: var(--button-text-color);
        /* border: 2px solid var(--header-border); */
        border: 0;
        border-radius: 25px;
        padding: 16px 32px;
        cursor: pointer;
      }

      .light-button {
        color: var(--text-color);
        background-color: transparent;
      }

      .light-button:hover {
        color: var(--text-color);
        background-color: var(--header-border);
      }

      .download-container button {
        margin-left: 3em;
      }

      header {
        position: fixed;
        top: 0;
        width: 100%;
        background-color: var(--background-color);
        color: var(--header-text);
        display: flex;
        align-items: center;
        padding: 15px 20px;
        /* box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); */
        z-index: 1000;
        transition: background-color 0.4s, color 0.4s;
        justify-content: center;
        border-bottom: 1px solid var(--header-border);
      }

      footer {
        border-top: 1px solid var(--header-border);
        width: 100%;
        display: flex;
        justify-content: center;
      }

      .footer-container {
        display: flex;
        max-width: 960px;
        padding: 2em 2em;
        gap: 1em;
        width: 100%;
      }

      .footer-container > div {
        flex-grow: 1;
      }

      .footer-container > div:first-child {
        flex-grow: 3;
      }

      .footer-container strong {
        margin-bottom: 1em;
        display: block;
      }

      .footer-container a {
        margin-bottom: 0.3em;
        display: block;
      }

    </style>

    <style>
      .hidden {
        display: none;
      }

	  h2 {
		margin: 0;
		padding: 0;
		margin-bottom: 0.6em;
	  }

      .profile {
		padding: 2em;
        display: flex;
        flex-direction: row;
        gap: 1em;
		min-width: 200px;
      }

	  .profile-info {
		border-right: 2px solid silver;
		padding-right: 1em;
		margin-right: 1em;
	  }
    </style>
  </head>
  <body>
	<div  class="hidden">
    <article id="template" class="profile">
      <div><img class="profile-image" /></div>
      <div>
		<h2>
		<span class="profile-name"></span><span class="profile-title hidden"></span>
		</h2>
		<span class="profile-status profile-info"></span>
		<span class="profile-location profile-info"></span>
		<span class="profile-bio profile-info"></span>
	</div>
      <div>
        <a class="profile-link" href=""><button>View on Ariton</button></a>
      </div>

      <!-- <figure>
        <a href="single.html"
          ><img src="images/pic_1.jpg" alt="Image" class="img-responsive"
        /></a>
      </figure> -->
      <!-- <span><a href="single.html" class="article-categories">Travel</a></span>
      <h2><a href="single.html" class="article-link"></a></h2>
      <div>March 6th, 2016</div> -->
    </article>
	</div>

    <div id="profile"></div>

    <footer>
      <p>
        <small
          >This is a profile powered by
          <a href="https://ariton.app">Ariton</a>.</small
        >
      </p>
    </footer>

    <script src="https://unpkg.com/@web5/api@0.11.0/dist/browser.js"></script>

    <script>
      var initializeWeb5 = async function () {
        const { web5, did: userDid } = await Web5.Web5.connect();
        console.log(web5, userDid);

        const urlParams = new URLSearchParams(window.location.search);
        const did = urlParams.get("did");

        const response = await web5.dwn.records.query({
          from: did,
          message: {
            filter: {
              author: did,
              protocol: "https://schema.ariton.app/profile",
              protocolPath: "profile",
              dataFormat: "application/json",
              schema: "https://schema.ariton.app/profile/schema/profile",
            },
          },
        });

        const template = document.getElementById("template");
        const parentElement = document.getElementById("profile");

        if (response.records.length === 0) {
          console.log("no records found");
        } else {
          const record = response.records[0];
          const entry = {
            record,
            data: await record.data.json(),
          };

          console.log("records found", entry);

          const clonedTemplate = template.cloneNode(true);
          clonedTemplate.classList.remove("hidden");

		//   clonedTemplate.querySelector("#profile-image").src = entry.data.image;
		  clonedTemplate.querySelector(".profile-name").innerText = entry.data.name ?? did;

		  if (entry.data.title) {
			  clonedTemplate.querySelector(".profile-title").innerText = `(${entry.data.title})`;
			  clonedTemplate.querySelector(".profile-title").classList.remove("hidden");
		  }

		  clonedTemplate.querySelector(".profile-status").innerText = entry.data.status;
		  clonedTemplate.querySelector(".profile-location").innerText = entry.data.location;
		  clonedTemplate.querySelector(".profile-bio").innerText = entry.data.bio;

		//   console.log(clonedTemplate.querySelector(".profile-link"))
		//   clonedTemplate.querySelector(".profile-link").src = 'https://alpha.ariton.app/profile/' + did;
		  
        //   clonedTemplate.querySelector(".img-responsive").src = entry.data.name;
        //   clonedTemplate.querySelector(".article-link").innerText =
        //     entry.data.title;

          //   clonedTemplate.querySelector(".article-categories").innerText =
          //     entry.data.labels.join(", ");

          // clonedTemplate.querySelector('.img-responsive').src = record.tags.image;
          // clonedTemplate.querySelector('.article-link').innerText = record.tags.title;
        //   clonedTemplate.querySelector(".article-date").innerText = new Date(
        //     entry.record.dateModified
        //   ).toLocaleDateString("en-US", {
        //     year: "numeric",
        //     month: "short",
        //     day: "numeric",
        //   });

          // Append the cloned template to the parent element
          parentElement.insertBefore(clonedTemplate, parentElement.firstChild);
        }

        // for (const record of response.records) {
        //   // We only retrieve the data for read-more.
        //   // const data = record.data.json();
        //   const clonedTemplate = template.cloneNode(true);

        //   // Remove a class by name from the cloned template
        //   clonedTemplate.classList.remove("hidden");

        //   const data = await record.data.json();
        //   console.log("data", data);

        //   clonedTemplate.querySelector(".img-responsive").src = data.image;
        //   clonedTemplate.querySelector(".article-link").innerText = data.title;
        //   clonedTemplate.querySelector(".article-categories").innerText =
        //     data.labels.join(", ");

        //   // clonedTemplate.querySelector('.img-responsive').src = record.tags.image;
        //   // clonedTemplate.querySelector('.article-link').innerText = record.tags.title;
        //   clonedTemplate.querySelector(".article-date").innerText = new Date(
        //     record.dateModified
        //   ).toLocaleDateString("en-US", {
        //     year: "numeric",
        //     month: "short",
        //     day: "numeric",
        //   });

        //   // Append the cloned template to the parent element
        //   parentElement.insertBefore(clonedTemplate, parentElement.firstChild);
        // }

        // template.classList.add("hidden");
      };

      (function () {
        console.log("initializing web5");
        initializeWeb5();
      })();
    </script>
  </body>
</html>
